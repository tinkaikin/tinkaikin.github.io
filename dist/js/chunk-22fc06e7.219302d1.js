(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22fc06e7"],{"0304":function(t,e,a){},e036:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"img"},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[a("my-bread",[t._v("素材管理")])],1),a("div",{staticClass:"car-body-t"},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.collectChange},model:{value:t.queryData.collect,callback:function(e){t.$set(t.queryData,"collect",e)},expression:"queryData.collect"}},[a("el-radio-button",{attrs:{label:!1}},[t._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[t._v("收藏")])],1),a("el-button",{staticStyle:{float:"right"},attrs:{type:"success",size:"small"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传素材")])],1),a("ul",{staticClass:"img-list"},t._l(t.imgList,function(e){return a("li",{key:e.id},[a("img",{attrs:{src:e.url,alt:""},on:{click:function(a){return t.previewImg(e.url)}}}),t.queryData.collect?t._e():a("div",{staticClass:"fot"},[a("span",{staticClass:"el-icon-star-off",class:{red:e.is_collected},on:{click:function(a){return t.toggleFav(e)}}}),a("span",{staticClass:"el-icon-delete",on:{click:function(a){return t.deleteBtn(e.id)}}})])])}),0),t.total>t.queryData.per_page?a("el-pagination",{attrs:{background:"",layout:"prev, pager, next, jumper","page-size":t.queryData.per_page,"current-page":t.queryData.page,total:t.total},on:{"current-change":t.pageChange}}):t._e()],1),a("el-dialog",{attrs:{title:"添加素材",visible:t.dialogVisible,width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:"http://ttapi.research.itcast.cn/mp/v1_0/user/images","show-file-list":!1,"on-success":t.handleImgSuccess,headers:t.headers,name:"image"}},[t.imageUrl?a("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{disabled:null===t.imageUrl},on:{click:function(e){t.dialogVisible=!1}}},[t._v("关 闭")])],1)],1),a("el-dialog",{attrs:{visible:t.dialogImg,width:"50%"},on:{"update:visible":function(e){t.dialogImg=e}}},[a("img",{attrs:{src:t.dialogImgUrl,alt:"",width:"100%",height:"100%"}})])],1)},s=[],n=(a("96cf"),a("3b8d")),r={data:function(){return{dialogImg:!1,dialogImgUrl:null,queryData:{collect:!1,page:1,per_page:10},total:0,imgList:[],loading:!1,dialogVisible:!1,imageUrl:null,headers:{Authorization:"Bearer "+JSON.parse(window.sessionStorage.getItem("chj74-toutiao")).token}}},created:function(){this.getimgListData()},methods:{previewImg:function(t){this.dialogImg=!0,this.dialogImgUrl=t},handleImgSuccess:function(t,e){var a=this;this.imageUrl=t.data.url,this.$message.success("上传成功"),window.setTimeout(function(){a.imageUrl=null,a.getimgListData(),a.dialogVisible=!1},3e3)},deleteBtn:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$http.delete("user/images/"+t);case 2:e.getimgListData(),e.$message({type:"success",message:"删除成功!"});case 4:case"end":return a.stop()}},a)}))).catch(function(){})},pageChange:function(t){this.queryData.page=t,this.getimgListData()},toggleFav:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$http.put("user/images/"+e.id,{collect:!e.is_collected});case 2:a=t.sent,i=a.data.data,this.$message.success("操作成功"),e.is_collected=i.collect;case 6:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),getimgListData:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,this.$http.get("user/images",{params:this.queryData});case 3:e=t.sent,a=e.data.data,this.imgList=a.results,this.total=a.total_count,this.loading=!1;case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),collectChange:function(){this.queryData.page=1,this.getimgListData()}}},l=r,o=(a("e13b"),a("2877")),c=Object(o["a"])(l,i,s,!1,null,"3a305070",null);e["default"]=c.exports},e13b:function(t,e,a){"use strict";var i=a("0304"),s=a.n(i);s.a}}]);
//# sourceMappingURL=chunk-22fc06e7.219302d1.js.map